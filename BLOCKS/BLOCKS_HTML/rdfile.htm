



<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">


<html>


<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></meta>
<title>



rdfile 



</title>
<style type="text/css">
<!--
.style2 {font-size: 12px}
.style3 {
	font-size: x-large;
	font-weight: bold;
}
.style5 {font-family: "Courier New", Courier, mono}
-->
</style>
</head>
<body>

<h1>



rdfile 



<a name="top"></a></h1>
<p><a href="http://www.xcad.com">Capsim</a> Block Documentation </p>
<ul>
  <li><a href="#license">License</a></li>
  <li><a href="#description">Description</a></li>
  <li><a href="#inputs">Input Connections</a></li>
  <li><a href="#outputs">Output Connections</a></li>
  <li><a href="#parameters">Parameters</a></li>
  <li><a href="#Results">Result Variables</a></li>
  <li><a href="#states">States</a></li>
  <li><a href="#declarations">Declarations</a></li>
  <li><a href="#initialization">Initialization Code</a></li>
  <li><a href="#maincode">Main Code</a></li>
  <li><a href="#wrapup">Wrapup Code</a></li>
</ul>





<h2>Short Description</h2><P>


This function performs the simple task of reading sample values in from a file, and then placing them on its output buffer. The file may have multiple sample values per line, which can be integer or float.


<h6><a href="#top">Top</a></h6>
<table width="746" border="1" cellspacing="1" cellpadding="1">
  <caption>
  <span class="style3">  Parameters<a name="parameters"></a> </span>
  </caption>
  <tr>
    <th width="58" scope="col">Num</th>
    <th width="373" scope="col">Description</th>
    <th width="80" scope="col">Type</th>
    <th width="98" scope="col">Name</th>
    <th width="109" scope="col">Default Value </th>
  </tr>

  


 <tr>
    <td>
    
    0
    
    </td>
    <td>
    
    File that contains data
    
    </td>
    <td>
    
    file
    
    </td>
    <td>
    
    file_name
    
    </td>
    <td>
    
    stdin
    
    </td>
    <td>
     </tr>
    
 



</table>




<h6><a href="#top">Top</a></h6>
<table width="746" border="1" cellspacing="1" cellpadding="1">
  <caption>
  <span class="style3">  States<a name="states"></a> </span>
  </caption>
  <tr>
    <th width="58" scope="col">Num</th>    
    <th width="80" scope="col">Type</th>
    <th width="98" scope="col">Name</th>
    <th width="109" scope="col">Initial Value </th>
    <th width="373" scope="col">Description</th>
  </tr>

  


 <tr>
    <td>
    
    0
    
    </td>
    <td>
    
  
    int
    
    </td>
    <td>
    
    obufs
    
    </td>
    <td>
    
    
    
    </td>
    <td>
    
      
    
    </td>
     </tr>
    
 



 <tr>
    <td>
    
    1
    
    </td>
    <td>
    
  
    FILE*
    
    </td>
    <td>
    
    fp
    
    </td>
    <td>
    
    
    
    </td>
    <td>
    
      
    
    </td>
     </tr>
    
 



 <tr>
    <td>
    
    2
    
    </td>
    <td>
    
  
    int
    
    </td>
    <td>
    
    done
    
    </td>
    <td>
    
    FALSE
    
    </td>
    <td>
    
      
    
    </td>
     </tr>
    
 



</table>




<h6><a href="#top">Top</a></h6>
<h2>Declarations<a name="declarations"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>

 

	int i,j;
	float x;
	FILE *fopen();



</pre>
    </div></th>
  </tr>
</table>




<h6><a href="#top">Top</a></h6>
<h2>Initialization Code<a name="initialization"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>


 

	if(strcmp(file_name,"stdin") == 0)
		fp = stdin;
	else if((fp = fopen(file_name,"r")) == NULL) {
		fprintf(stderr,"read_file: cannot open file\n");
		return(1); /* file cannot be opened */
	}
	if( (obufs = NO_OUTPUT_BUFFERS()) < 1 ) {
		fprintf(stderr,"read_file: no output buffers\n");
		return(2);
	}




</pre>
    </div></th>
  </tr>
</table>




<h6><a href="#top">Top</a></h6>
<h2>Main Code<a name="maincode"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>


 

	if(done)return(0);
	/* output a maximum of NUMBER_SAMPLES_PER_VISIT samples to output buffer(s) */
	for(i=0; i < NUMBER_SAMPLES_PER_VISIT; ++i) {

		/* Read input lines until EOF */
		if(feof(fp)) {
			done=TRUE;
			return(0);

		}
		fscanf(fp,"%f",&x); 

		/* input sample available: */
		/* increment time on output buffer(s) */
		/* and output a sample */
		for(j=0; j<obufs; j++) {
			if(IT_OUT(j)) {
				KrnOverflow("rdfile",j);
				return(99);
			}
			OUTF(j,0) = x;
		}
	}




</pre>
    </div></th>
  </tr>
</table>




<h6><a href="#top">Top</a></h6>
<h2>Wrapup Code<a name="wrapup"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>


 

        if (fp != stdout)
             fclose(fp);
        return(0);




</pre>
    </div></th>
  </tr>
</table>




<h6><a href="#top">Top</a></h6>
<h2>License<a name="license"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>


/*  Capsim (r) Text Mode Kernel (TMK) Star Library (Blocks)
    Copyright (C) 1989-2017  Silicon DSP Corporation

    This library is free software; you can redistribute it and/or
    modify it under the terms of the GNU Lesser General Public
    License as published by the Free Software Foundation; either
    version 2.1 of the License, or (at your option) any later version.

    This library is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
    Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public
    License along with this library; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

    http://www.silicondsp.com
    Silicon DSP  Corporation
    Las Vegas, Nevada
*/


</pre>
    </div></th>
  </tr>
</table>




<h6><a href="#top">Top</a></h6>
<h2>Description<a name="description"></a></h2>
<table width="754" height="98" border="1" cellpadding="1" cellspacing="1">
  <tr>
    <th class="style5" scope="col"><div align="left"> 
      <pre>


 

/*************************************************************
			rdfile()
***************************************************************
This function performs the simple task of reading
sample values in from a file, and then placing them on
it's output buffer. The file may have multiple sample values
per line, which can be integer or float.
An example use for this routine is to access a stored waveform
as input to a simulation.
The parameters are:
	file_name = name of file to read from, defaults to "stdin"
Typical usage:
param file input_file
star Reader read_file.s
param default
star Reader read_file.s
(The first version will read from the file with name input_file,
	while the second version will read from standard input)
<NAME>
rdfile
</NAME>
<DESCRIPTION>
This function performs the simple task of reading
sample values in from a file, and then placing them on
it's output buffer. The file may have multiple sample values
per line, which can be integer or float.
An example use for this routine is to access a stored waveform
as input to a simulation.
The parameters are:
	file_name = name of file to read from, defaults to "stdin"
Typical usage:
param file input_file
star Reader read_file.s
param default
star Reader read_file.s
(The first version will read from the file with name input_file,
	while the second version will read from standard input)
</DESCRIPTION>
<PROGRAMMERS>
Programmer: R. T. Wietelmann / D.G.Messerschmitt
Date: June 5, 1982
Modified for V2.0 by D.G. Messerschmitt March 7, 1985
Modified: July 10, 1985 by D.J.Hait
Modified: April, 1988 L.J.Faber: add "auto-fanout"
</PROGRAMMERS>	
*/




</pre>
    </div></th>
  </tr>
</table>




</body>
</html>


