/*
 * 		STAR_NAME()
 *
 * Generated by stargen
 *
 * Image Probe Star
 * Notes:
 *    This is a star generated from the image probe template
 *    It will input a sample, and print it to the console. If an
 *    output buffer is connected, the input sample 
 *    is outputted unmodified
 * 
 *    
 * Programmer: 
 * Date: 
 * Modified: 
 *
 */



parameters

PARAMETERS

end

states
	int numberInputBuffers;
	int numberOutputBuffers;
end

declarations
	int i,j,k;
	int ii,jj;
	float fpixel;
	image_t img;
end

initialization_code

   /*
    * Get the number of input buffers.
    * return if none connected with an error
    */
   if((numberInputBuffers = no_input_buffers()) <= 0) {
	   sprintf(cs_consoleBuffer,"STAR_NAME: no input buffers\n");PrintConsole();
	   return(1);
   }

   /*
    * Get the number of output buffers.
    * return if greater then number of input buffers with an error
    */

   if((numberOutputBuffers = no_output_buffers()) > numberInputBuffers) {
	  sprintf(cs_consoleBuffer,"STAR_NAME: more output than input buffers\n");PrintConsole();
	  return(2);
   }

   /*
    * set buffer sizes to int
    */
   for(i=0; i< numberInputBuffers; i++)
			set_cellsize_in(i,sizeof(image_t));
   for(i=0; i< numberOutputBuffers; i++)
			set_cellsize_out(0,sizeof(image_t));

end

main_code
	
	/* 
	 * This mode synchronizes all input buffers 
	 */
	for(i = min_avail(); i>0; i--) {
		for(j=0; j<numberInputBuffers; ++j) {
		
		    /*
		     * point to input sample
		     */
			it_in(j);
			
			if(j < numberOutputBuffers) {
			    /*
			     * just send samples from input to output buffers
			     */
				if(it_out(j)) {
					KrnOverflow("STAR_NAME",j);
					return(99);
				}
			    outimage(j,0) = inimage(j,0);

			}
			
			img=inimage(j,0);
           /*
            * This is just to show haow to access the pixels
            */
        
           for(ii=0; ii< img.height; ii++) {
        
              for (jj=0; jj<img.width; jj++) {
                 fpixel=img.image_PP[ii][jj];
           
           
              }
           }
			 


		}
		    
	}


    return(0);

end

wrapup_code

end


